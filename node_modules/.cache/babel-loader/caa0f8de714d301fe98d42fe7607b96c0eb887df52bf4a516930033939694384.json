{"ast":null,"code":"/**\n * Authentication Context\n * Manages user authentication state across the application\n */import React,{createContext,useContext,useState,useEffect,useCallback}from'react';import authService from'../services/authService';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);// Check if user is authenticated on mount\nuseEffect(()=>{checkAuth();},[]);// Check authentication status\nconst checkAuth=useCallback(async()=>{const token=localStorage.getItem('token');if(!token){setLoading(false);return;}try{const userData=await authService.getCurrentUser();setUser(userData);}catch(err){console.error('Auth check failed:',err);localStorage.removeItem('token');setUser(null);}finally{setLoading(false);}},[]);// Login with email/password\nconst login=async(email,password)=>{try{setError(null);setLoading(true);const data=await authService.login(email,password);localStorage.setItem('token',data.token);setUser(data.user);return data.user;}catch(err){const message=err.message||'Login failed. Please check your credentials.';setError(message);throw new Error(message);}finally{setLoading(false);}};// Register new user\nconst register=async userData=>{try{setError(null);setLoading(true);const data=await authService.register(userData);localStorage.setItem('token',data.token);setUser(data.user);return data.user;}catch(err){const message=err.message||'Registration failed. Please try again.';setError(message);throw new Error(message);}finally{setLoading(false);}};// Login with Google OAuth\nconst loginWithGoogle=async()=>{try{setError(null);// Redirect to Google OAuth endpoint\nconst clientId=process.env.REACT_APP_GOOGLE_CLIENT_ID;const redirectUri=\"\".concat(window.location.origin,\"/auth/google/callback\");const scope='openid email profile';const authUrl=\"https://accounts.google.com/o/oauth2/v2/auth?\"+\"client_id=\".concat(clientId,\"&\")+\"redirect_uri=\".concat(encodeURIComponent(redirectUri),\"&\")+\"response_type=code&\"+\"scope=\".concat(encodeURIComponent(scope),\"&\")+\"access_type=offline&\"+\"prompt=consent\";window.location.href=authUrl;}catch(err){const message=err.message||'Google login failed.';setError(message);throw new Error(message);}};// Logout user\nconst logout=useCallback(async()=>{try{setLoading(true);await authService.logout();}catch(err){console.error('Logout error:',err);}finally{localStorage.removeItem('token');setUser(null);setLoading(false);}},[]);// Update user profile\nconst updateProfile=async userData=>{try{setError(null);setLoading(true);const updatedUser=await authService.updateProfile(userData);setUser(updatedUser);return updatedUser;}catch(err){const message=err.message||'Profile update failed.';setError(message);throw new Error(message);}finally{setLoading(false);}};// Clear error\nconst clearError=()=>{setError(null);};// Value provided to consumers\nconst value={user,loading,error,isAuthenticated:!!user,login,register,loginWithGoogle,logout,updateProfile,clearError,checkAuth};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};export default AuthContext;","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","authService","jsx","_jsx","AuthContext","useAuth","context","Error","AuthProvider","_ref","children","user","setUser","loading","setLoading","error","setError","checkAuth","token","localStorage","getItem","userData","getCurrentUser","err","console","removeItem","login","email","password","data","setItem","message","register","loginWithGoogle","clientId","process","env","REACT_APP_GOOGLE_CLIENT_ID","redirectUri","concat","window","location","origin","scope","authUrl","encodeURIComponent","href","logout","updateProfile","updatedUser","clearError","value","isAuthenticated","Provider"],"sources":["/Users/mac/Desktop/academic-marketplace/client/src/context/AuthContext.jsx"],"sourcesContent":["/**\n * Authentication Context\n * Manages user authentication state across the application\n */\n\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport authService from '../services/authService';\n\nconst AuthContext = createContext(null);\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Check if user is authenticated on mount\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  // Check authentication status\n  const checkAuth = useCallback(async () => {\n    const token = localStorage.getItem('token');\n\n    if (!token) {\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const userData = await authService.getCurrentUser();\n      setUser(userData);\n    } catch (err) {\n      console.error('Auth check failed:', err);\n      localStorage.removeItem('token');\n      setUser(null);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  // Login with email/password\n  const login = async (email, password) => {\n    try {\n      setError(null);\n      setLoading(true);\n\n      const data = await authService.login(email, password);\n\n      localStorage.setItem('token', data.token);\n      setUser(data.user);\n\n      return data.user;\n    } catch (err) {\n      const message = err.message || 'Login failed. Please check your credentials.';\n      setError(message);\n      throw new Error(message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Register new user\n  const register = async (userData) => {\n    try {\n      setError(null);\n      setLoading(true);\n\n      const data = await authService.register(userData);\n\n      localStorage.setItem('token', data.token);\n      setUser(data.user);\n\n      return data.user;\n    } catch (err) {\n      const message = err.message || 'Registration failed. Please try again.';\n      setError(message);\n      throw new Error(message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Login with Google OAuth\n  const loginWithGoogle = async () => {\n    try {\n      setError(null);\n\n      // Redirect to Google OAuth endpoint\n      const clientId = process.env.REACT_APP_GOOGLE_CLIENT_ID;\n      const redirectUri = `${window.location.origin}/auth/google/callback`;\n      const scope = 'openid email profile';\n\n      const authUrl = `https://accounts.google.com/o/oauth2/v2/auth?` +\n        `client_id=${clientId}&` +\n        `redirect_uri=${encodeURIComponent(redirectUri)}&` +\n        `response_type=code&` +\n        `scope=${encodeURIComponent(scope)}&` +\n        `access_type=offline&` +\n        `prompt=consent`;\n\n      window.location.href = authUrl;\n    } catch (err) {\n      const message = err.message || 'Google login failed.';\n      setError(message);\n      throw new Error(message);\n    }\n  };\n\n  // Logout user\n  const logout = useCallback(async () => {\n    try {\n      setLoading(true);\n      await authService.logout();\n    } catch (err) {\n      console.error('Logout error:', err);\n    } finally {\n      localStorage.removeItem('token');\n      setUser(null);\n      setLoading(false);\n    }\n  }, []);\n\n  // Update user profile\n  const updateProfile = async (userData) => {\n    try {\n      setError(null);\n      setLoading(true);\n\n      const updatedUser = await authService.updateProfile(userData);\n      setUser(updatedUser);\n\n      return updatedUser;\n    } catch (err) {\n      const message = err.message || 'Profile update failed.';\n      setError(message);\n      throw new Error(message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Clear error\n  const clearError = () => {\n    setError(null);\n  };\n\n  // Value provided to consumers\n  const value = {\n    user,\n    loading,\n    error,\n    isAuthenticated: !!user,\n    login,\n    register,\n    loginWithGoogle,\n    logout,\n    updateProfile,\n    clearError,\n    checkAuth,\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport default AuthContext;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}